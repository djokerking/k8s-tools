### 项目简介
* 自动化部署Kubernetes(v1.19.0)环境
* 深入学习和理解k8s各组件的关系及使用方式

### 安装方式
* 通过参数的方式设置部署规则
* 具有安装部署、添加和移除计算节点、关闭和启动集群的功能

### 环境准备
* Centos7系列操作系统，最小化安装
* Python2.7
 
##### 参数描述
| 参数 | 描述| 
| :--  | :--- |
|install | 动作，支持install（安装）、addnode|renode（添加和移除节点）stop|start（关闭和启动节点）|
|--hosts | 主机列表,用分号隔开,如: ip1,ip2,ip3...|
|--names | 主机名,需要一一对应,用分号隔开,如: node1,node2,node3...|
|--etcd | etcd所在主机名列表,默认前三个,用分号隔开,如: node1,node2,node3...默认前三个节点|
|--keepalive | 是否开启k8s高可用,默认关闭|
|--master | master所在主机名列表,默认前三个,用分号隔开,如: node1,node2,node3...高可用开启时生效|
|--etcd | 指定etcd节点，如果不指定则默认前三个节点|
|--vip | 指定集群apiserver的虚IP,高可用开启时生效|

##### 部署参考
1. 初始化安装
```
./controller.py  install \
--hosts 192.168.31.11,192.168.31.12,192.168.31.13,192.168.31.14,192.168.31.15,192.168.31.16 \
--name node11,node12,node13,node14,node15,node16 \
--vip 192.168.31.19
```

2. 添加和移除节点
```
```
3. 关闭和启动集群
```
```

### 注意
- [x] 现阶段etcd参数和master参数的主机名都仅仅支持三个节点，如果多出三个节点则的配置会失效
---
### 未来计划
- [ ] 优化部署方式及细粒度控制部署组件
- [ ] 自动制作镜像实现静态pod
- [ ] 本地仓库启动及docker拉去镜像证书认证
- [ ] 组件参数：支持通过参数的方式配置详细参数
- [ ] 优化部署流程、节点扩充及证书替换等操作

### 更新日志
- 20201025: 
  - 上传项目到git托管，完成部分k8s的nginx反向代理高可用
- 20201026: 
  - 修改keepalived自动部署到主节点(当前仅支持两个apiserver主节点)<br>
  - 使用with_items优化部署脚本
- 20201027: 
  - 更新k8s启动参数
- 20201108:
  - 考虑使用Python来完成入口脚本
- 20201225:
  - 完成初始化安装部署部分
